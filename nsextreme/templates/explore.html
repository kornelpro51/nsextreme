{% extends "base.html" %}

{% load bootstrap_toolkit %}

{% block title %}Explore{% endblock %}
{% block head_additional %}
    <script src="{{ MEDIA_URL }}js/masonry/masonry.pkgd.min.js"></script>
    {% if not user.is_authenticated %}
    <link href="{{ STATIC_URL }}django_facebook/css/facebook.css">
    {% endif %}
    <script src="{{ MEDIA_URL }}js/bootbox/bootbox.min.js"></script>
    <script src="{{ MEDIA_URL }}js/jscroll/jquery.jscroll.js"></script>
{% endblock %}
{% block content %}
<script type="text/javascript">
    var MOREVIDEOSEXIST = true;
    {% if next_page == None %}
    MOREVIDEOSEXIST = false;
    {% endif %}
</script>
<div class="row-fluid">
    <div class="span2 categories">
        <div class="widget box-category">
            <ul>
                <li class="{% if current_category == None %}active{% endif %}"><a href="{% url 'explore' %}">All</a></li>
            {% for category in category_list %}
                <li id="cl_{{ category.id }}" class="{% if current_category == category.id %}active{% endif %}"><a href="{% url 'explore_c' categoryid=category.id %}">{{ category.title }}</a></li>
            {% endfor %}
            </ul>
        </div>
    </div>
    <div class="span8 widget">
        <div class="row-fluid video-thumb-container">
        {% for video in video_list %}
            {% include "explore_video_thumb.html" with video=video shared=True %}
            {% if forloop.counter|divisibleby:2 %}
            <div class="clearfix"></div>
            {% endif %}
        {% endfor %}
        {% if next_page %}
            <a class="next_link" href="{{ next_page }}">next page</a>
        {% endif %}
        </div>
    </div>
    <div class="span2">
        <div class="row-fluid widget box-category">
            {% if user.is_authenticated %}
            <ul>
                <li class="{% if current_category == 'favorites' %}active{% endif %}"><a href="{% url 'favorites' %}">Favorites</a></li>
                <li class="{% if current_category == 'popular' %}active{% endif %}"><a href="{% url 'popular' %}">Popular</a></li>
                <li class="{% if current_category == 'toppicks' %}active{% endif %}"><a href="{% url 'toppicks' %}">Top picks</a></li>
                <li class="{% if current_category == 'recommended' %}active{% endif %}"><a href="{% url 'recommended' %}">Recommended</a></li>
            </ul>
            {% else %}
            <ul>
                <li><a class="need_auth" data-description="Please sign in to visit Bookmark page." href="#">Favorites</a></li>
                <li><a class="need_auth" data-description="Please sign in to visit Popular page." href="#">Popular</a></li>
                <li><a class="need_auth" data-description="Please sign in to visit Top picks page." href="#">Top picks</a></li>
                <li><a class="need_auth" data-description="Please sign in to visit Recommended page." href="#">Recommended</a></li>
            </ul>
            {% endif %}
        </div>
        <div class="row-fluid widget">
            <div class="banner-ad">

            </div>
        </div>
    </div>
</div>
    {% if not user.is_authenticated %}
    <div id="modal_login" class="modal hide fade">
        <div class="modal-body">
            {% include 'django_facebook/_facebook_js.html' %}
            <h1>Login</h1>
            <form action="{% url 'facebook_connect' %}?facebook_login=1" method="post">
                <input type="hidden" value="{{ request.path }}" name="next" />
                <input type="hidden" value="{{ request.path }}" name="register_next" />
                <input type="hidden" value="{{ request.path }}" name="error_next" />
                {% csrf_token %}
                <input onclick="F.connect(this.parentNode); return false;" type="image" src="{{ STATIC_URL }}django_facebook/images/facebook_login.png" />
            </form>
            <form method="post" action="/accounts/login/?next=/explore" class="form-horizontal">
                {% csrf_token %}
                <input id="id_username" type="text" name="username" placeholder="Email">
                <input id="id_password" type="password" name="password" placeholder="Password">
                <button type="submit" class="btn btn-primary btn-small">Login</button>
            </form>
        </div>
    </div>
    {% endif %}
<script src="{{ MEDIA_URL }}js/explore_page.js"></script>
{% endblock %}

